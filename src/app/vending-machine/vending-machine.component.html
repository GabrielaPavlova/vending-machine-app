<div class="vending-machine">
  <app-coins (coinInserted)="insertCoin($event)"></app-coins>
  <app-product-list [products]="products$ | async"></app-product-list>
  <app-select-product
    [products]="products$ | async"
    (productSelected)="selectProduct($event)"
  ></app-select-product>
  <app-control-panel-vm
    [totalInserted]="calculateTotalInsertedCoins()"
    [selectedProduct]="selectedProduct"
    [changeToReturn]="changeToReturn"
    (buyClicked)="buyProduct()"
    (resetClicked)="resetProcess()"
  ></app-control-panel-vm>
</div>

<div *ngFor="let product of products$ | async">
  {{ product.name }} - {{ product.price }}
  <button (click)="editProduct(product)">Edit</button>
  <button (click)="deleteProduct(product.id)">Delete</button>
</div>
<button (click)="addProduct()">Add Product</button>

<!-- Add Product Form -->
<div *ngIf="showAddProductForm">
  <h2>Add Product</h2>
  <form (submit)="saveProduct()">
    <label for="productName">Name:</label>
    <input
      type="text"
      id="productName"
      name="newProductName"
      [(ngModel)]="newProduct.name"
      required
    />
    <label for="productPrice">Price:</label>
    <input
      type="number"
      id="productPrice"
      name="newProducPrice"
      [(ngModel)]="newProduct.price"
      required
    />

    <button type="submit">Save</button>
    <button type="button" (click)="cancelAddProduct()">Cancel</button>
  </form>
</div>

<!-- Edit Product Form -->
<div *ngIf="showEditProductForm">
  <h2>Edit Product</h2>
  <form (submit)="updateProduct()">
    <label for="editProductName">Name:</label>
    <input
      type="text"
      id="editProductName"
      name="editProductName"
      [(ngModel)]="editedProduct.name"
      required
    />

    <label for="editProductPrice">Price:</label>
    <input
      type="number"
      id="editProductPrice"
      name="editProductPrice"
      [(ngModel)]="editedProduct.price"
      required
    />
    <button type="submit">Update</button>
    <button type="button" (click)="cancelEditProduct()">Cancel</button>
  </form>
</div>
